![https://www.utec.edu.pe/sites/default/files/logo_0.png](http://www.utec.edu.pe/sites/default/files/logo_utec_.png)

# Comercial Api V2 CONFIG


**Version**

1.1

# Colaboradores

* Richard Leon Ingaruca(rleon@utec.edu.pe)

# Base de Datos

```sql

DECLARE
  IN_USERINSERT VARCHAR2(59)   := 'rleon';

  V_CODMOD_COMERCIAL NUMBER(10) := 24; -- MODULO COMERCIAL
  V_CODAPP_COMERCIAL_API NUMBER(10) := 27; -- COMERCIAL API REST

  V_CODMENU_COMERCIAL NUMBER(10);

  V_CODROL_GOD     NUMBER(10) := 1;
  V_CODROL_ADMINIS NUMBER(10) := 11;
  V_CODROL_ALUMNO NUMBER(10) := 12;

  V_CODSEDE        NUMBER(10) := 2;
  V_TEMP_CODROLSEDE NUMBER(10);

BEGIN

  -- BORRAR DATA INGRESADA
  DELETE FROM SEGURIDAD.SEG_OPCION_ROL_SEDE WHERE CODOPCION IN (SELECT CODOPCION FROM SEG_OPCION WHERE CODAPLICACION = V_CODAPP_COMERCIAL_API);
  DELETE FROM SEG_OPCION WHERE CODAPLICACION = V_CODAPP_COMERCIAL_API;
  DELETE FROM SEGURIDAD.SEG_ROL_MODULO WHERE CODMODULO = V_CODMOD_COMERCIAL;
  DELETE FROM SEGURIDAD.SEG_MODULO_APLICACION WHERE CODMODULO = V_CODMOD_COMERCIAL;  
  DELETE FROM SEG_APLICACION WHERE CODAPLICACION = V_CODAPP_COMERCIAL_API;
  DELETE FROM SEG_MODULO WHERE CODMODULO = V_CODMOD_COMERCIAL;

  INSERT INTO SEGURIDAD.SEG_MODULO (CODMODULO, IDMODULO, NOMBREMODULO, USERINSERT, ISDELETED) VALUES (V_CODMOD_COMERCIAL, 'COMERCIAL', 'COMERCIAL', 'ScriptsDataInicial', 'N'); -- Practicas Pre Profesionales
  INSERT INTO SEG_APLICACION (CODAPLICACION, IDAPLICACION, NOMBREAPLICACION, RUTAHOST, NROPUERTO, RUTACONTEXTO, USERINSERT, ISDELETED) VALUES (V_CODAPP_COMERCIAL_API, 'COMERCIAL_API', 'API REST COMERCIAL', 'https://localhost', '8999', '', 'ScriptsDataInicial', 'N');

  INSERT INTO SEGURIDAD.SEG_MODULO_APLICACION (CODMODULO, CODAPLICACION, ESTADO, USERINSERT, ISDELETED) VALUES (V_CODMOD_COMERCIAL, V_CODAPP_COMERCIAL_API, 'A', IN_USERINSERT, 'N');

  -- CREAR OPCIONES DE MENU
  SELECT SEG_OPCION_S.NEXTVAL INTO V_CODMENU_COMERCIAL FROM DUAL;
  INSERT INTO SEGURIDAD.SEG_OPCION (CODOPCION, TIPOOPCION, DESCRIPCIONLARGA, DESCRIPCIONCORTA, OPCIONPADRE, USERINSERT, ISDELETED,CODAPLICACION, CONTEXTO)
  VALUES  (V_CODMENU_COMERCIAL, 'M', 'Comercial', 'comercial', null, IN_USERINSERT,'N', V_CODAPP_COMERCIAL_API, '/empresa');

  -- ASOCIAR OPCIONES DE MENU AL ROL: GOD

  SELECT CODROLSEDE INTO V_TEMP_CODROLSEDE FROM SEGURIDAD.SEG_ROL_SEDE WHERE CODROL = V_CODROL_GOD AND CODSEDE = V_CODSEDE AND ISDELETED = 'N';
  INSERT INTO SEGURIDAD.SEG_OPCION_ROL_SEDE (CODOPCION, CODROLSEDE, HABILITADO, VISIBLE, USERINSERT, ISDELETED) VALUES (V_CODMENU_COMERCIAL, V_TEMP_CODROLSEDE, 'Y', 'Y', IN_USERINSERT, 'N');

  -- ASOCIAR OPCIONES DE MENU AL ROL: JEFE DE SECRETARIA ACADEMICA

  SELECT CODROLSEDE INTO V_TEMP_CODROLSEDE FROM SEGURIDAD.SEG_ROL_SEDE WHERE CODROL = V_CODROL_ADMINIS AND CODSEDE = V_CODSEDE AND ISDELETED = 'N';
  INSERT INTO SEGURIDAD.SEG_OPCION_ROL_SEDE (CODOPCION, CODROLSEDE, HABILITADO, VISIBLE, USERINSERT, ISDELETED) VALUES (V_CODMENU_COMERCIAL, V_TEMP_CODROLSEDE, 'Y', 'Y', IN_USERINSERT, 'N');

  --ASOCIAR OPCIONES DE MENU AL ALUMNO
  SELECT CODROLSEDE INTO V_TEMP_CODROLSEDE FROM SEGURIDAD.SEG_ROL_SEDE WHERE CODROL = V_CODROL_ALUMNO AND CODSEDE = V_CODSEDE AND ISDELETED = 'N';
  INSERT INTO SEGURIDAD.SEG_OPCION_ROL_SEDE (CODOPCION, CODROLSEDE, HABILITADO, VISIBLE, USERINSERT, ISDELETED) VALUES (V_CODMENU_COMERCIAL, V_TEMP_CODROLSEDE, 'Y', 'Y', IN_USERINSERT, 'N');

  -- ASOCIAR ROLES AL MODULO:
  INSERT INTO SEGURIDAD.SEG_ROL_MODULO (CODROL, CODMODULO, ESTADO, USERINSERT, ISDELETED) VALUES (V_CODROL_GOD, V_CODMOD_COMERCIAL, 'A', IN_USERINSERT, 'N');
  INSERT INTO SEGURIDAD.SEG_ROL_MODULO (CODROL, CODMODULO, ESTADO, USERINSERT, ISDELETED) VALUES (V_CODROL_ADMINIS, V_CODMOD_COMERCIAL, 'A', IN_USERINSERT, 'N');
  INSERT INTO SEGURIDAD.SEG_ROL_MODULO (CODROL, CODMODULO, ESTADO, USERINSERT, ISDELETED) VALUES (V_CODROL_ALUMNO, V_CODMOD_COMERCIAL, 'A', IN_USERINSERT, 'N');

END;

```
